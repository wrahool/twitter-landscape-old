library(reshape)
library(ggplot2)
library(plyr)
setwd("C:/Users/Subhayan/Documents/Work/twitter-landscape//")
#without NAs
#elites
elite_df = read.csv("data/weak_elite_ideologies.csv", as.is = T)
elite_df = elite_df[!is.na(elite_df$ideology),]
#those with -Inf and +Inf ideologies are assigned very low and very high values instead.
#+/-3 is chosen because all other elites have absolute ideologies less than 3.
elite_df[elite_df$ideology == -Inf,]$ideology = -3
elite_df[elite_df$ideology == Inf,]$ideology = 3
names(elite_df)[2] = "ideology"
elites = elite_df$username
elite_freq = read.csv("data/elites_activity.csv", as.is = T)
names(elite_freq)[1] = "username"
elite_freq$numberoftweets_scaled = (elite_freq$numberoftweets - min(elite_freq$numberoftweets))/(max(elite_freq$numberoftweets) - min(elite_freq$numberoftweets))
elite_df$username = tolower(elite_df$username)
elite_freq_df = merge(elite_df, elite_freq)
elite_freq_df$corrected_ideology = elite_freq_df$ideology * elite_freq_df$numberoftweets_scaled
elite_freq_viz = elite_freq_df[,c(1, 2, 5)]
elite_freq_viz_long = melt(elite_freq_viz, id.vars= "username")
mu <- ddply(elite_freq_viz_long, "variable", summarise, grp.mean=mean(value, na.rm = T))
p3_withoutNA = ggplot(elite_freq_viz_long, aes(x=value, fill=variable)) +
geom_density(alpha=0.4) +
geom_vline(data=mu, aes(xintercept=grp.mean, color=variable),
linetype="dashed") +
scale_colour_manual(values = c("#E7B800", "#FC4E07")) +
scale_fill_manual(values = c("#E7B800", "#FC4E07")) +
theme_bw() +
theme(legend.position = "none")
#elites without neutrals: weighted vs unweighted
#with NAs
library(reshape)
#elites
elite_df = read.csv("data/weak_elite_ideologies.csv", as.is = T)
#those with -Inf and +Inf ideologies are assigned very low and very high values instead.
#+/-3 is chosen because all other elites have absolute ideologies less than 3.
elite_df[is.na(elite_df$ideology),]$ideology = 0
elite_df[elite_df$ideology == -Inf,]$ideology = -3
elite_df[elite_df$ideology == Inf,]$ideology = 3
names(elite_df)[2] = "ideology"
elites = elite_df$username
elite_freq = read.csv("data/elites_activity.csv", as.is = T)
names(elite_freq)[1] = "username"
elite_freq$numberoftweets_scaled = (elite_freq$numberoftweets - min(elite_freq$numberoftweets))/(max(elite_freq$numberoftweets) - min(elite_freq$numberoftweets))
elite_df$username = tolower(elite_df$username)
elite_freq_df = merge(elite_df, elite_freq)
elite_freq_df$corrected_ideology = elite_freq_df$ideology * elite_freq_df$numberoftweets_scaled
elite_freq_viz = elite_freq_df[,c(1, 2, 5)]
elite_freq_viz_long = melt(elite_freq_viz, id.vars= "username")
mu <- ddply(elite_freq_viz_long, "variable", summarise, grp.mean=mean(value, na.rm = T))
p4_withNA = ggplot(elite_freq_viz_long, aes(x=value, fill=variable)) +
geom_density(alpha=0.4) +
geom_vline(data=mu, aes(xintercept=grp.mean, color=variable),
linetype="dashed") +
scale_colour_manual(values = c("#E7B800", "#FC4E07")) +
scale_fill_manual(values = c("#E7B800", "#FC4E07")) +
theme_bw() +
theme(legend.position = "none")
#elites with neutrals: weighted vs unweighted
library(gridExtra)
#figure 4
grid.arrange(p3_withoutNA, p4_withNA, nrow = 1)
MC_article_fig2_A = ggplot(elite_freq_viz_long[elite_freq_viz_long$variable == "ideology",],) +
geom_density(alpha=0.4, aes(x=value), fill = "yellow") +
geom_vline(xintercept = mu[mu$variable == "ideology",]$grp.mean, linetype="dashed") +
theme_bw() +
scale_y_continuous(breaks=seq(0, 10, 2))+
ylim(c(0, 10.5))
MC_article_fig2_B = ggplot(elite_freq_viz_long[elite_freq_viz_long$variable == "corrected_ideology",],) +
geom_density(alpha=0.4, aes(x=value), fill = "orange") +
geom_vline(xintercept = mu[mu$variable == "corrected_ideology",]$grp.mean, linetype="dashed") +
theme_bw() +
scale_y_continuous(breaks=seq(0, 10, 2))+
ylim(c(0, 10.5))
grid.arrange(MC_article_fig2_A, MC_article_fig2_B, nrow = 1)
MC_article_fig2_A = ggplot(elite_freq_viz_long[elite_freq_viz_long$variable == "ideology",],) +
geom_density(alpha=0.4, aes(x=value), fill = "brown") +
geom_vline(xintercept = mu[mu$variable == "ideology",]$grp.mean, linetype="dashed") +
theme_bw() +
scale_y_continuous(breaks=seq(0, 10, 2))+
ylim(c(0, 10.5))
MC_article_fig2_B = ggplot(elite_freq_viz_long[elite_freq_viz_long$variable == "corrected_ideology",],) +
geom_density(alpha=0.4, aes(x=value), fill = "orange") +
geom_vline(xintercept = mu[mu$variable == "corrected_ideology",]$grp.mean, linetype="dashed") +
theme_bw() +
scale_y_continuous(breaks=seq(0, 10, 2))+
ylim(c(0, 10.5))
grid.arrange(MC_article_fig2_A, MC_article_fig2_B, nrow = 1)
